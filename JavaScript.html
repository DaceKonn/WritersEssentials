<script>

window.addEventListener('load', function() {
  console.log('Page is loaded');
});

var dashData = {};

var statTemplate = `<div class="stat-card mdl-card mdl-shadow--2dp mdl-cell mdl-cell--2-col mdl-cell--2-col-tablet mdl-cell--2-col-desktop">
              <div class="mdl-card__title mdl-card--expand">
                <h2 class="mdl-card__title-text">{title}</h2>
              </div>
              <div class="mdl-card__supporting-text mdl-color-text--grey-600">
                <span id="{id}" class="stat-support-text">{value}</span>
              </div>
            </div>`;

function onSuccessGetDashboardData(result) {

        
        dashData = result;
        var div = document.getElementById('mainGrid');
        result.Stats.forEach(element => {
            addStatCard(div, element);
        });
        
      }

function replaceInnerHtml(id, newContet) {
    var div = document.getElementById(id);
    div.innerHTML = newContet;
}

function addStatCard(div, stat){

var value;

if (/\d{4}z\d{2}-\d{2}$/.test(stat.Value)) {

value = stat.Value.replace("z", "-");

}
else {

value = stat.Value;

}


    div.innerHTML += statTemplate
        .replace("{id}", stat.Id)
        .replace("{title}", stat.DisplayName)
        .replace("{value}", value);
}

google.script.run.withSuccessHandler(onSuccessGetDashboardData).GetDashboardData();


</script>